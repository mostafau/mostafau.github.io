
\documentclass[12pt]{amsart}
\usepackage{times}
\usepackage{mdwlist}
\usepackage{courier}
\usepackage{fancybox}
\usepackage{shadow}
\usepackage{rotating}
\usepackage{epsfig}
\usepackage{url}
\usepackage{listings}
\usepackage{color}
%\usepackage{setspace}
%\usepackage{graphicx}
\usepackage{caption} 
\usepackage{amsmath}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{caption}
\usepackage{geometry} % see geometry.pdf on how to lay out the page. There's lots.
\geometry{a4paper} % or letter or a5paper or ... etc
% \geometry{landscape} % rotated page geometry

% See the ``Article customise'' template for come common customisations

\title{}
\author{}
\date{} % delete this line to display the current date

%%% BEGIN DOCUMENT
\begin{document}


\section{Abstract}

This invention enables a fast and accurate detection of network flow types such as video streaming, voice-over-IP and video conferencing by leveraging unique frequency-temporal features of network packet sizes and inter-packet time. 

\section{Problem}

A user application running on mobile or any client device (PC, laptop, smartphone)
creates different type of network flows. For example, in Skype some flows are delay
sensitive like the real-time video/voice chat flow. On
the other hand some flows in Skype are non delay sensitive,
which are the control flows, IM flows or media sharing
flows. Similarly, in facebook app you have media file
sharing flows, web content flows, Advertising flows, video
steaming flows etc. In order to provide best users quality
of experience (QoE), each type of flows require different
awareness to the network operator. Therefore, we need fine-grained
flow level classification to identify/classify different
type network flows from each devices. Unlike the previous
work, where the focus was to classify and detect different
apps, our objective is to identify different type
of flows.
Every year, with increasing number of app of similar type,
make it unscalable to detect or classify every app. In addition,
the developer might add new features or functionality
to the app in different version. Thus, the app can generate
new type of flows at its different version. Therefore,
instead of identifying the app or app type, our objective is
to identifying the type of flows. Among all these flow types,
the audio/video streaming flow and the real-time video/voice
chat or VOIP are the two most important flow correspond to
users quality of experience (QoE)

In this invention, we use Machine Learning (ML) classifier to identify these two flows. In building
the proper classifier, collecting fine-grained ground truth data
is essential. However, with the growing number of mobile
applications, it is challenging to accurately annotate the training flows generated by a single application. Therefore having
the ground truth data is challenging. There is lack of tools
that can address this problem. In this paper, we address this
challenge by including the end device in designing the system
framework to collect ground-truth data. Thus, in our
system framework we collect the ground-truth information
about the appâ€™s flows from the client device to build or train
the ML classifier model online and real-time. 

\section{Previous work}

Ref.[1] employed a similar approach to collect ground truths from client devices but it was unable to differentiate diverse flow types generated by a single application. 

Even if we obtain ground truth for a certain application, it's challenging to obtain accurate ground truth from each and every application running on client devices. For our knowledge, there is no previous work to address this scalability issue, for example, by using a classifier trained by ground truth of one application to classify flow types of other similar applications. 

[1] Application-Awareness in SDN, ACM Sigcomm 2013.

\section{Solution description}

\begin{figure*}
	\centering
	\includegraphics[width=0.9\linewidth,  angle = 0]{Invention\_train.pdf}
	\caption{\textbf{Train ML classifier model.}} 
	\label{fig:system}
\end{figure*}

In this invention, we describe a framework to build a Machine Learning classifier to identify mainly two types of flow, media streaming and real-time video/voice chat. In building the classifier, we leverage the end devices to collect the ground-truth information about these two flows in real-time. Followed by building the classifier, the framework can detect/identify these two flows regardless of network condition (packet loss, out-of-order transmission) and the app that are generating the flow. In other word, our classifier model is able to detect the flow type even if it is generated from a completely new app. 

\subsection{Ground-truth Data Collection}
In the framework, we have some registered or selected mobile devices in the network that continuously provide information about the flow and the flow type to the Global/Network controller. These selected mobile devices run a \textit{Mobile Agent} that collects the ground truth of the running apps and their corresponding flows from the \textit{netstat} network libraries. This is similar to Ref. [1]. Compared to [1], we also have the selected devices to run a modified \textit{Open vSwitch} to collect additional information such as flow packet sizes, inter-packet time. We modified the Open vSwitch and the OpenFlow protocol to collect the recent $N$ number of packets' sizes and arrival times. Here, we set the value of $N$ large enough, so that we can have enough recent history of the flow's packet reception and transmission. 

In addition, the \textit{Mobile Agent} also monitor the activity of the acoustic sensors (microphone and speaker) and camera sensor. Knowing the running app and these sensing information helps the \textit{Mobile Agent} to infer the label of the flow type. For example, when user run Skype app, there are many flows it generate. But knowing, when the user starts the video/ voice conversation from the sensing information of camera and acoustic, the \text{Mobile Agent} can map the flow that initiated that time as the real-time video/voice chat type flow in Skype. Similarly, while using Youtube we see lot of flows get generated. Among then only one flow will correspond to the video streaming flow. In such cases, only the flow that has a long duration and/or the frequent large payload sizes is likely to be a streaming flow. Thus using the \textit{Mobile Agent} can identify the streaming and the real-time flows from the known app and we can use those flow-type information label training flows and generate ground truth for machine learning. 

In the global controller, we have a module for training the ML classifier. This module communicates with the \textit{Mobile Agent} to collect the ground-truth data about the flows, and then trains the classifier model.  

\subsection{Feature Extraction}
In respect to the client device, a network flow has two direction of packet flow, incoming and outgoing. Both the incoming and outgoing have same pair of source and destination address (ip and port), but they are opposite in each other. In feature extraction, we use both direction of flow. Unlike the most previous approach where feature is extracted over the whole flow, in this framework we slices  the flows into series of fixed time window (i.e 200ms) for both directions. Then we apply our feature extraction over each time window. The feature that we use are number of packets and bytes  transmitted and received within the time window,  port number, protocol, first order and second order statistics of the Inter Packet Time (IPT) and the packet size for both direction of flow within the time window. In addition, we use a unique features, where we apply Discrete Wavelet Transform (DWT) to the time-series of IDT and packet size for both direction for the time window. 


\subsection{Discrete Wavelet Transform (DWT)}

The sequence of packet sizes or inter packet times (IPT) in a network flow can be treated as a time-series signal, where consecutive values usually tend to be highly correlated. However, most traditional approaches tend to extract only the first order (mean, median) and/or second order (variance) statistics of these signal thus failing to encode any higher order dependencies in a network flow sample. One efficient approach to address this problem is to transform the time series signal into a frequency domain to extract spectral features that are uncorrelated and can reveal the higher order structure in the signal.

\cite{} has proposed the use of Discrete Fourier Transform (DFT) on packet size and IPT signals to extract spectral features for traffic classification. DFT decomposes a time-series signal into different frequency components that encode the periodicity of the signal. However, a DFT can only capture global features thereby loosing information on any local variations. Moreover, a DFT assumes that the signals are stationary, i.e, they do not change over time. 

However, most real world time series signals are not stationary including the packet size and IPT signals. Hence, we propose to use a Discrete Wavelet Transform (DWT), which does not assume stationarity, while capturing both frequency and temporal information by mapping the signals into a joint time-frequency domain. A wavelet transform is computed using scaled, and shifted versions of a wavelet function, such as a Haar function, or a Daubechy function.  

%The sequence of packet size or the Inter Arrival Time(IAT) in a traffic flow is a time-series data. In time-series data, consecutive values are usually not independent, but highly correlated. Therefore it is challenging to develop effective feature selection technique directly on the time series data. In order to address this challenge, time series cab be transformed from the time domain into another domain to de-correlate the time features and reveal the hidden structure of the series. For example, the Fourier transform(DFT, DCT and STFT) map the time-series data from the time domain to the frequency domain to extract the spectral features. In previous works~\cite{} Discrete Fourier Transform(DFT) has been applied over the time-series data of packet size and IAT to extract the features for traffic classification. The Fourier transform decompose the time-series signal data into different frequency components to detect different periodicity of the signal. However, the Fourier transform provides insufficient information due to the non-localized nature of the transform in time domain. For example, it fails to detect the abrupt changes or the discontinuity in time of the non-stationary data. 

%For example, when we use a small time window in calculating the features, it is highly unlikely that we find any periodic pattern within the short time window, which might exists over longer period of window time. Instead we will see more discontinuity or abrupt spike in the time series signal. In that case, the DWT can locate and map such time series signal in feature space. Unlike the Fourier transform, wavelet transform  are based on small waves, called wavelets. Wavelets are obtained from a single prototype wavelet called mother wavelet by dilations and contractions as well as shifts. Note that, we use Discrete Wavelet Transform(DWT) with haar as our wavelet function for extracting the features from the time-series data. 


%Fourier Transform (DCF or DFT or STFT) extract the periodic feature of a signal. They don't capture the temporal locality features as like the Discrete Wavelet Transform.
%Fourier transform decompose a time series signal into different frequency component. Its unable to pick up local frequency content.





 
 \begin{figure*}[htb]
\centering
\subfloat[]{
  \includegraphics[width=0.33\linewidth]{window1.pdf}\label{fig:ps_window1}
}
\subfloat[]{
  \includegraphics[width=0.33\linewidth]{window2.pdf}\label{fig:ps_window2}
}
\subfloat[]{
  \includegraphics[width=0.33\linewidth]{window3.pdf}\label{fig:ps_window3}
}
\caption{ (a) The original time-series data(left). (b) The modified time-series data with removing the periodic spike (middle). (c) The modified time-series data with removing the abrupt change spike (right). }
\end{figure*}
 
 
Figure ~\ref{fig:ps_window1} shows the plot of a time-series signal for packet sizes over a time window of 200 millisec. This time window consists of three spikes with the first and last spike exhibiting a periodic behavior, while the middle spike denotes a non-periodic local variation. Figures \ref{fig:ps_window2} and \ref{fig:ps_window3} show modified versions of this time-series with the last and middle spikes removed, respectively. Figure \ref{fig:ps_fft} shows the DFT co-efficients for these three time series signals. It can be noted from this figure that the Fourier transform for both the original time series and the modified version with the middle spike removed are similar and show constant minor difference across the entire co-efficients, which demonstrates the failure of Fourier transform in properly capturing local variations. On the other hand, the Fourier transform for the modified version with the end (periodic) spike removed is significantly different from that of the original time series, which demonstrates the sensitivity of the Fourier transform to minor variations in the time-series signal. 


\begin{figure*}[htb]
\centering
\subfloat[]{
  \includegraphics[width=0.49\linewidth]{window_fft.pdf}\label{fig:ps_fft}
}
\subfloat[]{
  \includegraphics[width=0.49\linewidth]{window_dwt.pdf}\label{fig:ps_dwt}
}
\caption{ (a) The DFT co-efficient for the original data and the modified data. (b) The DWT co-efficient for the original data and the modified data. }
\end{figure*}

The plot \ref{fig:ps_dwt} shows the value of wavelet transform co-efficient for three different time series signal from figure 2. In the plot \ref{fig:ps_dwt}, the red line is for the original time-series data(\ref{fig:ps_window1}), the blue line is for the \ref{fig:ps_window2} and the magenta line is for the \ref{fig:ps_window3}. Unlike the DFT, in DWT the change in the abrupt spike doesn't make changes over the entire co-efficient values and rather makes a few noticeable differences, thus localizing the local variance in the co-efficient space, which makes the DWT co-efficients as better machine learning features. In addition, we see in DWT co-efficient, both changes of figure \ref{fig:ps_window2} and \ref{fig:ps_window3} are different from the original time series data (red line), but they are also consistent. Thus make the DWT co-efficient feature more robust and at the same distinguishable compare to DFT for different scenarios.





%It can be shown that we can both have frequency and temporal information by this kind of transform using wavelets. In addition, many real-world time series are not periodic. For example, the time-series data of packet size or IAT within such short time window has less chance of having periodicity. The wavelet transform overcome this shortcoming by mapping the time-series data into a joint time-frequency domain.  




\subsection{Real-Time Classification}

\begin{figure*}
	\centering
	\includegraphics[width=0.9\linewidth,  angle = 0]{invention\_detection.pdf}
	\caption{\textbf{Online detection of flow types.}} 
	\label{fig:system}
\end{figure*}


After building the classifier, the classification model identify the flows in real-time. Unlike the existing IDT-based approaches that classify the flow after it finishes, we start classify the flow as soon as we capture the flow for the duration of a minimum time window, for example, 200ms in our testing. The classification result can be used to take actions (such as increasing QoS level or blocking the flow) with minimum latency from the start of the flow.  To improve reliability, we keep collecting packet sizes and IPT from the flow until we reach the maximum time window limit (e.g., 5000ms), and we keep extracting the features and classifying the flow during this time. More likely the classification output will get more consistent and reliable as we extract the flow features from a large time window.  Once we classify the flow type, the global controller take corresponding action provide by the network admin or operator based on the flow type.

The classification can also be performed at client devices, in addition to APs or other network devices. 

%Similar to the feature extraction in the training, in testing we collect the feature from each flow for a fixed time window. Then, we use the features to classify/identify the flow type. Based on flow type, global controller take corresponding action provide by the network admin or operator. Unlike the existing approach of classifying the flow after it finishes, in our framework we can identify the flow within the time window, which can be 200ms to 5000ms. 

\end{document}